import * as admin from 'firebase-admin'

if (admin.apps.length == 0) {
  const credential = JSON.parse(
    Buffer.from(
      process.env.GCP_CREDENTIAL +
        'b0NUVzhRamk2R0hFL1dcbjBlbHJHUEVvQUxwVEhTTHRlS0ZFSWNNVGJRS0JnUURlVS9QNGFiMUMxOFZHYTFiYm85NFVtVTZkNmVvRWFtQnhcbkhRY1FOdXR0V3lNNHRCUFY5bXpqbjFNTXV5djVmNnN5UmJmM1RGUEI2a2d4RFV0N1RZQlpnVTN4bHEybXdpRTZcblh4ay9xWHZoUW1FZUpyMmhEUGJvTkx6aU5xbTd3S3lhWkZnQ1Y2N2hRNUZiV2c0NDZ3TURleDFmMDZQS0drKzFcblRDcU5hNVZtVVFLQmdRQ2I0N213dTBCeG5mRVZvMTB5QVJqaUZhQlVQaGw5ODZiNm90SDgySjBtb1cvSjJaSUZcbjEwZmhuS2ZtTk1PeXNqN3lIeFZRZDJsVm1oME9lQXlqckIwNURuL2VwSlhkN3V1Wi9UT0Rvc25sdE1nMzJOd3RcbjZwaFFOOUN0RGF2RzRVcjQrMWZJTDIxTnB3WWN6bTUrcWU3OHBXRTNScHpOUW8yTDIyYThCeng4VVFLQmdCRmhcbkdLb3JnZHJ1eVFJSE5BUDVYRXZaN0JaV0NiQU1yTHRLM0psODRZeHIybVg5VmF1ZEZzZjRWV0tpWXY2ZTUwQUhcbnlTaXdzNzl0MC9UWnFEUGNUQk16RTJlMk1wN2RnQUZ6RzZNcFdZQ3pVcW9ydHhrV3pWbzdmU1JseDREZ3Y5MVZcbnlMZHVLVUo4cUtrdWNmd3JDdEpEMW5qK0wwaUdKQUwxRUVKN3pYTHhBb0dCQUlUaHcrQmxZY2syR0ZMUHArUjJcbnVjb2ExamRUZVk4VytLckh1RWFDQldMQXNaNWpqSlYrbVdlSXVuSityeC9RNk9KMUtrWW9ndXNYcytFV3JQY3hcbjNubEVZV3k3bG5mV0IvdFFTKzJzUHVLUVYrNFNTeGlkN2wyanV3d1Z4bDdZMWlDN3dqMmhjYlVJS1pYZ2hQSXJcblZVVFdNbElpaHFxZkp4UzlDZnlDQXBlZFxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogImZpcmViYXNlLWFkbWluc2RrLXZ2NmVyQG5leHRqcy1maXJlYmFzZS1zYW1wbGUtZjg1YTIuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJjbGllbnRfaWQiOiAiMTAxMTQ4NTUxNjYxNTY2NzU1NzY5IiwKICAiYXV0aF91cmkiOiAiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGgiLAogICJ0b2tlbl91cmkiOiAiaHR0cHM6Ly9vYXV0aDIuZ29vZ2xlYXBpcy5jb20vdG9rZW4iLAogICJhdXRoX3Byb3ZpZGVyX3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vb2F1dGgyL3YxL2NlcnRzIiwKICAiY2xpZW50X3g1MDlfY2VydF91cmwiOiAiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vcm9ib3QvdjEvbWV0YWRhdGEveDUwOS9maXJlYmFzZS1hZG1pbnNkay12djZlciU0MG5leHRqcy1maXJlYmFzZS1zYW1wbGUtZjg1YTIuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iCn0',
      'base64'
    ).toString()
  )

  admin.initializeApp({
    databaseURL: process.env.NEXT_PUBLIC_FIREBASE_DATABASE_URL,
    credential: admin.credential.cert(credential),
  })
}
